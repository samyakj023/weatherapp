{"ast":null,"code":"import { catchError, filter, forkJoin, map, of, switchMap, tap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./services/api/api.service\";\nimport * as i2 from \"./services/store/store.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"./components/city-select/city-select.component\";\nimport * as i5 from \"./components/today-weather/today-weather.component\";\nimport * as i6 from \"./components/future-weather/future-weather.component\";\n\nfunction AppComponent_ng_container_2_h1_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h1\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r3.error);\n  }\n}\n\nfunction AppComponent_ng_container_2_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"app-today-weather\", 3)(2, \"app-future-weather\", 4);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const data_r2 = i0.ɵɵnextContext().ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"weather\", data_r2 == null ? null : data_r2.weather);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"forecast\", data_r2 == null ? null : data_r2.forecast);\n  }\n}\n\nfunction AppComponent_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, AppComponent_ng_container_2_h1_1_Template, 2, 1, \"h1\", 1);\n    i0.ɵɵtemplate(2, AppComponent_ng_container_2_div_2_Template, 3, 2, \"div\", 1);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.loader && ctx_r0.error);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.loader && !ctx_r0.error);\n  }\n}\n\nfunction AppComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵelement(1, \"div\", 6);\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport class AppComponent {\n  constructor(apiService, storeService) {\n    this.apiService = apiService;\n    this.storeService = storeService;\n    this.loader = true;\n    this.error = '';\n    this.weatherForecast$ = this.storeService.selectedCity$.pipe(filter(data => !!data), filter(city => city.nm !== ''), tap(() => this.loader = true), switchMap(city => this.fetchWeatherForecast(city)), map(([weather, forecast, error]) => ({\n      weather,\n      forecast,\n      error\n    })), tap(({\n      weather\n    }) => {\n      if (weather) {\n        this.loader = false;\n        this.error = '';\n      }\n    }));\n  }\n\n  fetchWeatherForecast(city) {\n    return forkJoin([this.apiService.getWeather(city), this.apiService.getForecast(city)]).pipe(catchError(() => {\n      this.error = 'Something went wrong';\n      this.loader = false;\n      return of([null, null, true]);\n    }));\n  }\n\n}\n\nAppComponent.ɵfac = function AppComponent_Factory(t) {\n  return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.StoreService));\n};\n\nAppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AppComponent,\n  selectors: [[\"app-root\"]],\n  decls: 5,\n  vars: 4,\n  consts: [[1, \"container\"], [4, \"ngIf\"], [\"class\", \"loader-container\", 4, \"ngIf\"], [3, \"weather\"], [3, \"forecast\"], [1, \"loader-container\"], [\"id\", \"loading\"]],\n  template: function AppComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelement(1, \"app-city-select\");\n      i0.ɵɵtemplate(2, AppComponent_ng_container_2_Template, 3, 2, \"ng-container\", 1);\n      i0.ɵɵpipe(3, \"async\");\n      i0.ɵɵtemplate(4, AppComponent_div_4_Template, 2, 0, \"div\", 2);\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(3, 2, ctx.weatherForecast$));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.loader);\n    }\n  },\n  dependencies: [i3.NgIf, i4.CitySelectComponent, i5.TodayWeatherComponent, i6.FutureWeatherComponent, i3.AsyncPipe],\n  styles: [\".container[_ngcontent-%COMP%] {\\n  max-width: 460px;\\n  border-radius: 25px;\\n  overflow: hidden;\\n  padding: 2rem;\\n  box-shadow: 0 0 0 10px #e9ebec, 0 0 0 11px #fcfdfe;\\n  background-color: #9234e7;\\n  position: relative;\\n  z-index: 1;\\n  margin: auto;\\n  margin-top: 2rem;\\n  color: white;\\n}\\n\\napp-today-weather[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n  font-size: 1.5rem;\\n}\\n\\napp-future-weather[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex: 1 1 0;\\n  width: 100%;\\n  font-size: 1.5rem;\\n}\\n\\n.loader-container[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  justify-content: center;\\n  height: 100%;\\n}\\n\\n#loading[_ngcontent-%COMP%] {\\n  width: 50px;\\n  height: 50px;\\n  border: 3px solid rgba(255, 255, 255, 0.3);\\n  border-radius: 50%;\\n  border-top-color: #fff;\\n  animation: spin 1s ease-in-out infinite;\\n  -webkit-animation: spin 1s ease-in-out infinite;\\n  margin: 3rem auto;\\n}\\n\\n@keyframes spin {\\n  to {\\n    -webkit-transform: rotate(360deg);\\n  }\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGdCQUFBO0VBQ0EsbUJBQUE7RUFDQSxnQkFBQTtFQUNBLGFBQUE7RUFDQSxrREFBQTtFQUNBLHlCQUFBO0VBQ0Esa0JBQUE7RUFDQSxVQUFBO0VBQ0EsWUFBQTtFQUNBLGdCQUFBO0VBQ0EsWUFBQTtBQUNGOztBQUVBO0VBQ0UsYUFBQTtFQUNBLHNCQUFBO0VBQ0EsaUJBQUE7QUFDRjs7QUFFQTtFQUNFLGFBQUE7RUFDQSxXQUFBO0VBQ0EsV0FBQTtFQUNBLGlCQUFBO0FBQ0Y7O0FBRUE7RUFDRSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0VBQ0EsWUFBQTtBQUNGOztBQUVBO0VBQ0UsV0FBQTtFQUNBLFlBQUE7RUFDQSwwQ0FBQTtFQUNBLGtCQUFBO0VBQ0Esc0JBQUE7RUFDQSx1Q0FBQTtFQUNBLCtDQUFBO0VBQ0EsaUJBQUE7QUFDRjs7QUFFQTtFQUNFO0lBQ0UsaUNBQUE7RUFDRjtBQUNGIiwiZmlsZSI6ImFwcC5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5jb250YWluZXIge1xyXG4gIG1heC13aWR0aDogNDYwcHg7XHJcbiAgYm9yZGVyLXJhZGl1czogMjVweDtcclxuICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gIHBhZGRpbmc6IDJyZW07XHJcbiAgYm94LXNoYWRvdzogMCAwIDAgMTBweCAjZTllYmVjLCAwIDAgMCAxMXB4ICNmY2ZkZmU7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzkyMzRlNztcclxuICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgei1pbmRleDogMTtcclxuICBtYXJnaW46IGF1dG87XHJcbiAgbWFyZ2luLXRvcDogMnJlbTtcclxuICBjb2xvcjogd2hpdGU7XHJcbn1cclxuXHJcbmFwcC10b2RheS13ZWF0aGVyIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgZm9udC1zaXplOiAxLjVyZW07XHJcbn1cclxuXHJcbmFwcC1mdXR1cmUtd2VhdGhlciB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4OiAxIDEgMDtcclxuICB3aWR0aDogMTAwJTtcclxuICBmb250LXNpemU6IDEuNXJlbTtcclxufVxyXG5cclxuLmxvYWRlci1jb250YWluZXIge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gIGhlaWdodDogMTAwJTtcclxufVxyXG5cclxuI2xvYWRpbmcge1xyXG4gIHdpZHRoOiA1MHB4O1xyXG4gIGhlaWdodDogNTBweDtcclxuICBib3JkZXI6IDNweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMyk7XHJcbiAgYm9yZGVyLXJhZGl1czogNTAlO1xyXG4gIGJvcmRlci10b3AtY29sb3I6ICNmZmY7XHJcbiAgYW5pbWF0aW9uOiBzcGluIDFzIGVhc2UtaW4tb3V0IGluZmluaXRlO1xyXG4gIC13ZWJraXQtYW5pbWF0aW9uOiBzcGluIDFzIGVhc2UtaW4tb3V0IGluZmluaXRlO1xyXG4gIG1hcmdpbjogM3JlbSBhdXRvO1xyXG59XHJcblxyXG5Aa2V5ZnJhbWVzIHNwaW4ge1xyXG4gIHRvIHtcclxuICAgIC13ZWJraXQtdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTtcclxuICB9XHJcbn1cclxuXHJcbkAtd2Via2l0LWtleWZyYW1lcyBzcGluIHtcclxuICB0byB7XHJcbiAgICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7XHJcbiAgfVxyXG59XHJcbiJdfQ== */\"],\n  changeDetection: 0\n});","map":{"version":3,"mappings":"AACA,SAASA,UAAT,EAAqBC,MAArB,EAA6BC,QAA7B,EAAuCC,GAAvC,EAA4CC,EAA5C,EAAgDC,SAAhD,EAA2DC,GAA3D,QAAsE,MAAtE;;;;;;;;;;;ICGIC;IAA6BA;IAAWA;;;;;IAAXA;IAAAA;;;;;;IAE7BA;IACEA,wCAAiE,CAAjE,EAAiE,oBAAjE,EAAiE,CAAjE;IAEFA;;;;;IAFqBA;IAAAA;IACCA;IAAAA;;;;;;IALxBA;IACEA;IAEAA;IAIFA;;;;;IANOA;IAAAA;IAECA;IAAAA;;;;;;IAMRA;IACEA;IACFA;;;;ADFF,OAAM,MAAOC,YAAP,CAAmB;EAkBvBC,YACUC,UADV,EAEUC,YAFV,EAEoC;IAD1B;IACA;IAnBH,cAAS,IAAT;IACA,aAAQ,EAAR;IAEA,wBAAmB,KAAKA,YAAL,CAAkBC,aAAlB,CAAgCC,IAAhC,CACxBZ,MAAM,CAAEa,IAAD,IAAU,CAAC,CAACA,IAAb,CADkB,EAExBb,MAAM,CAAEc,IAAD,IAAUA,IAAK,CAACC,EAAN,KAAa,EAAxB,CAFkB,EAGxBV,GAAG,CAAC,MAAO,KAAKW,MAAL,GAAc,IAAtB,CAHqB,EAIxBZ,SAAS,CAAEU,IAAD,IAAU,KAAKG,oBAAL,CAA0BH,IAA1B,CAAX,CAJe,EAKxBZ,GAAG,CAAC,CAAC,CAACgB,OAAD,EAAUC,QAAV,EAAoBC,KAApB,CAAD,MAAiC;MAAEF,OAAF;MAAWC,QAAX;MAAqBC;IAArB,CAAjC,CAAD,CALqB,EAMxBf,GAAG,CAAC,CAAC;MAAEa;IAAF,CAAD,KAAgB;MAClB,IAAIA,OAAJ,EAAa;QACX,KAAKF,MAAL,GAAc,KAAd;QACA,KAAKI,KAAL,GAAa,EAAb;MACD;IACF,CALE,CANqB,CAAnB;EAiBH;;EAEIH,oBAAoB,CAACH,IAAD,EAAW;IACrC,OAAOb,QAAQ,CAAC,CACd,KAAKQ,UAAL,CAAgBY,UAAhB,CAA2BP,IAA3B,CADc,EAEd,KAAKL,UAAL,CAAgBa,WAAhB,CAA4BR,IAA5B,CAFc,CAAD,CAAR,CAGJF,IAHI,CAILb,UAAU,CAAC,MAAK;MACd,KAAKqB,KAAL,GAAa,sBAAb;MACA,KAAKJ,MAAL,GAAc,KAAd;MACA,OAAOb,EAAE,CAAC,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CAAD,CAAT;IACD,CAJS,CAJL,CAAP;EAUD;;AAlCsB;;;mBAAZI,cAAYD;AAAA;;;QAAZC;EAAYgB;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCZzBrB;MACEA;MAEAA;;MASAA;MAGFA;;;;MAZiBA;MAAAA;MASTA;MAAAA","names":["catchError","filter","forkJoin","map","of","switchMap","tap","i0","AppComponent","constructor","apiService","storeService","selectedCity$","pipe","data","city","nm","loader","fetchWeatherForecast","weather","forecast","error","getWeather","getForecast","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\Coolp\\weather-app\\src\\app\\app.component.ts","C:\\Users\\Coolp\\weather-app\\src\\app\\app.component.html"],"sourcesContent":["import { ChangeDetectionStrategy, Component } from '@angular/core';\r\nimport { catchError, filter, forkJoin, map, of, switchMap, tap } from 'rxjs';\r\nimport { City } from './interfaces/city-intf';\r\nimport { ApiService } from './services/api/api.service';\r\nimport { StoreService } from './services/store/store.service';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class AppComponent {\r\n  public loader = true;\r\n  public error = '';\r\n\r\n  public weatherForecast$ = this.storeService.selectedCity$.pipe(\r\n    filter((data) => !!data),\r\n    filter((city) => city!.nm !== ''),\r\n    tap(() => (this.loader = true)),\r\n    switchMap((city) => this.fetchWeatherForecast(city!)),\r\n    map(([weather, forecast, error]) => ({ weather, forecast, error })),\r\n    tap(({ weather }) => {\r\n      if (weather) {\r\n        this.loader = false;\r\n        this.error = '';\r\n      }\r\n    })\r\n  );\r\n\r\n  constructor(\r\n    private apiService: ApiService,\r\n    private storeService: StoreService\r\n  ) {}\r\n\r\n  private fetchWeatherForecast(city: City) {\r\n    return forkJoin([\r\n      this.apiService.getWeather(city),\r\n      this.apiService.getForecast(city),\r\n    ]).pipe(\r\n      catchError(() => {\r\n        this.error = 'Something went wrong';\r\n        this.loader = false;\r\n        return of([null, null, true]);\r\n      })\r\n    );\r\n  }\r\n}\r\n","<div class=\"container\">\r\n  <app-city-select></app-city-select>\r\n\r\n  <ng-container *ngIf=\"weatherForecast$ | async as data\">\r\n    <h1 *ngIf=\"!loader && error\">{{ error }}</h1>\r\n\r\n    <div *ngIf=\"!loader && !error\">\r\n      <app-today-weather [weather]=\"data?.weather\"></app-today-weather>\r\n      <app-future-weather [forecast]=\"data?.forecast\"></app-future-weather>\r\n    </div>\r\n  </ng-container>\r\n\r\n  <div *ngIf=\"loader\" class=\"loader-container\">\r\n    <div id=\"loading\"></div>\r\n  </div>\r\n</div>\r\n"]},"metadata":{},"sourceType":"module"}